<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Nouse Safety Net Estimator</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js"
            integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.4.0/js/bootstrap.min.js"
            integrity="sha256-oKpAiD7qu3bXrWRVxnXLV1h7FlNV+p5YJBIr8LOCFYw=" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.4.0/css/bootstrap.min.css"
          integrity="sha256-/ykJw/wDxMa0AQhHDYfuMEwVb4JHMx9h4jD4XvHqVzU=" crossorigin="anonymous"/>
    <style>
    </style>
</head>
<body>
<div class="container-fluid">
    <div class="row">
        <div class="col-md-3 col-sm-12">
            <div class="jumbotron">
                <p class="lead">Nouse Safety Net Estimator</p>
                <p>This estimator is intended to be a good copy of the one provided by the University, but re-designed
                    to handle larger amounts of traffic. </p>
                <hr class="my-4">
                <p>Nouse is the University of York's Oldest Student Society</p>
                <p class="lead">
                    <a class="btn btn-secondary btn-sm" href="https://nouse.co.uk" target="_blank" role="button">Nouse Website</a>
                    <a class="btn btn-info btn-sm" href="https://coronavirus.york.ac.uk/" target="_blank" role="button">University Coronavirus Guidance</a>
                </p>
            </div>
            <a href="instructions.jpg" target="_blank"><img src="instructions.jpg" style="width: 100%;" alt="Instructions for use"></a>
        </div>
        <div class="col-md-9 col-sm-12">
            <table class="table">
                <tr>
                    <th style="width: 10%">
                        #
                    </th>
                    <th style="width: 30%;">
                        Assessment Mark %
                    </th>
                    <th style="width: 30%;">
                        Assessment Weighting %
                    </th>
                    <th style="width: 30%;">
                        Module Credits
                    </th>
                </tr>
                <tr>
                    <td>
                        1
                    </td>
                    <td>
                        <input type="number" max="100" min="0" class="form-control" id="assmark1"
                               placeholder="Assessment Mark as a %">
                    </td>
                    <td>
                        <input type="number" max="100" min="0" class="form-control" id="assweight1"
                               placeholder="Assessment Weighting as a %">
                    </td>
                    <td>
                        <input type="number" max="500" min="0" class="form-control" id="asscred1"
                               placeholder="Module Credits">
                    </td>
                </tr>
                <tr>
                    <td>
                        2
                    </td>
                    <td>
                        <input type="number" max="100" min="0" class="form-control" id="assmark2"
                               placeholder="Assessment Mark as a %">
                    </td>
                    <td>
                        <input type="number" max="100" min="0" class="form-control" id="assweight2"
                               placeholder="Assessment Weighting as a %">
                    </td>
                    <td>
                        <input type="number" max="500" min="0" class="form-control" id="asscred2"
                               placeholder="Module Credits">
                    </td>
                </tr>
                <tr>
                    <td>
                        3
                    </td>
                    <td>
                        <input type="number" max="100" min="0" class="form-control" id="assmark3"
                               placeholder="Assessment Mark as a %">
                    </td>
                    <td>
                        <input type="number" max="100" min="0" class="form-control" id="assweight3"
                               placeholder="Assessment Weighting as a %">
                    </td>
                    <td>
                        <input type="number" max="500" min="0" class="form-control" id="asscred3"
                               placeholder="Module Credits">
                    </td>
                </tr>
                <tr>
                    <td>
                        4
                    </td>
                    <td>
                        <input type="number" max="100" min="0" class="form-control" id="assmark4"
                               placeholder="Assessment Mark as a %">
                    </td>
                    <td>
                        <input type="number" max="100" min="0" class="form-control" id="assweight4"
                               placeholder="Assessment Weighting as a %">
                    </td>
                    <td>
                        <input type="number" max="500" min="0" class="form-control" id="asscred4"
                               placeholder="Module Credits">
                    </td>
                </tr>
                <tr>
                    <td>
                        5
                    </td>
                    <td>
                        <input type="number" max="100" min="0" class="form-control" id="assmark5"
                               placeholder="Assessment Mark as a %">
                    </td>
                    <td>
                        <input type="number" max="100" min="0" class="form-control" id="assweight5"
                               placeholder="Assessment Weighting as a %">
                    </td>
                    <td>
                        <input type="number" max="500" min="0" class="form-control" id="asscred5"
                               placeholder="Module Credits">
                    </td>
                </tr>
                <tr>
                    <td>
                        6
                    </td>
                    <td>
                        <input type="number" max="100" min="0" class="form-control" id="assmark6"
                               placeholder="Assessment Mark as a %">
                    </td>
                    <td>
                        <input type="number" max="100" min="0" class="form-control" id="assweight6"
                               placeholder="Assessment Weighting as a %">
                    </td>
                    <td>
                        <input type="number" max="500" min="0" class="form-control" id="asscred6"
                               placeholder="Module Credits">
                    </td>
                </tr>
                <tr>
                    <td>
                        7
                    </td>
                    <td>
                        <input type="number" max="100" min="0" class="form-control" id="assmark7"
                               placeholder="Assessment Mark as a %">
                    </td>
                    <td>
                        <input type="number" max="100" min="0" class="form-control" id="assweight7"
                               placeholder="Assessment Weighting as a %">
                    </td>
                    <td>
                        <input type="number" max="500" min="0" class="form-control" id="asscred7"
                               placeholder="Module Credits">
                    </td>
                </tr>
                <tr>
                    <td>
                        8
                    </td>
                    <td>
                        <input type="number" max="100" min="0" class="form-control" id="assmark8"
                               placeholder="Assessment Mark as a %">
                    </td>
                    <td>
                        <input type="number" max="100" min="0" class="form-control" id="assweight8"
                               placeholder="Assessment Weighting as a %">
                    </td>
                    <td>
                        <input type="number" max="500" min="0" class="form-control" id="asscred8"
                               placeholder="Module Credits">
                    </td>
                </tr>
                <tr style="display:none;">
                    <td>
                        9
                    </td>
                    <td>
                        <input type="number" max="100" min="0" class="form-control" id="assmark9"
                               placeholder="Assessment Mark as a %">
                    </td>
                    <td>
                        <input type="number" max="100" min="0" class="form-control" id="assweight9"
                               placeholder="Assessment Weighting as a %">
                    </td>
                    <td>
                        <input type="number" max="500" min="0" class="form-control" id="asscred9"
                               placeholder="Module Credits">
                    </td>
                </tr>
                <tr style="display:none;">
                    <td>
                        10
                    </td>
                    <td>
                        <input type="number" max="100" min="0" class="form-control" id="assmark10"
                               placeholder="Assessment Mark as a %">
                    </td>
                    <td>
                        <input type="number" max="100" min="0" class="form-control" id="assweight10"
                               placeholder="Assessment Weighting as a %">
                    </td>
                    <td>
                        <input type="number" max="500" min="0" class="form-control" id="asscred10"
                               placeholder="Module Credits">
                    </td>
                </tr>
                <tr>
                    <td colspan="3" style="font-weight: bold;">
                        Last year's credit weighted mean
                    </td>
                    <td>
                        Last Year's Weighting
                    </td>
                </tr>
                <tr>
                    <td colspan="3">
                        <input type="number" max="100" min="0" class="form-control" id="lastyear"
                               placeholder="Last Year's Credit Weighted Mean From evision">
                    </td>
                    <td id="lastyearweight">
                        0
                    </td>
                </tr>
                <tr>
                    <td colspan="3" style="font-weight: bold;">
                        Your Safety Net (estimate)
                    </td>
                    <td colspan="1" id="safetynet" style="background-color: #01ff1a;">
                        <i>Estimate will display when more data is entered</i>
                    </td>
                </tr>

            </table>
            <p>No data is stored or transmitted by this tool. It is accurate to the best of our knowledge but
                neither Nouse, nor their parent organisation (<a href="https://yusu.org" target="_blank">University of York Student's Union</a>), can be held
                accountable for any errors or the results/impacts of errors that might occur in it's calculations. Users
                are advised to consult with University Authorities before making decisions based on results provided
                here. Please email <a href="mailto:web@nouse.co.uk">web@nouse.co.uk</a> with any enquiries.</p>
            <p>Tool designed and built 3rd April 2020 by <a href="https://jbithell.com" target="_blank">James
                Bithell</a>. Licenced under MIT License</p>
        </div>
    </div>
</div>

</body>
<script>
    var courseCredits = 120;

    function calculateResult() {
        console.log("---------------------------------------------");
        var i;
        var thisYearScore = 0.0;
        var credits = 0.0;
        var lastYearWeight = 0.0;
        for (i = 1; i < 11; i++) {
            var cred = $("#asscred" + i).val();
            var weight = $("#assweight" + i).val();
            var mark = $("#assmark" + i).val();
            if (cred != null && weight != null && mark != null) {
                //They've filled out that result
                cred = parseFloat(cred);
                weight = parseFloat(weight);
                mark = parseFloat(mark);
                if (isNaN(cred) != true && isNaN(weight) != true && isNaN(mark) != true) {
                    //That result was made up of floats so is allowed
                    console.log("Parse and count assessment " + i);
                    credits = credits + (cred * (weight / 100));
                    thisYearScore = thisYearScore + ((mark) * (((weight / 100) * cred) / courseCredits));
                }
            }
        }

        var result = thisYearScore;
        if (credits < 60) {
            var lastYear = $("#lastyear").val();
            if (lastYear != null) {
                lastYear = parseFloat(lastYear);
                if (isNaN(lastYear) != true) {
                    lastYearWeight = ((60 - credits) / 60);
                    result = result + (lastYear * ((60 - credits) / courseCredits));
                    console.log("Added last year");
                    credits = credits + (60 - credits);
                } else {
                    console.log("Next year data needed but not available - not a number");
                    return false;
                }
            } else {
                console.log("Next year data needed but not available - null");
                return false;
            }
        }
        if (credits < courseCredits) {
            console.log("Bumped all results by " + (courseCredits / credits) + " as not a full 120 credits in year - only " + credits);
            result = result * (courseCredits / credits);
        }
        if (result > 0) {
            return {
                "value": result,
                "lastYearWeight": lastYearWeight
            }
        } else {
            return false;
        }
    }

    $(document).ready(function () {
        $("input").change(function () {
            var result = calculateResult();
            if (result) {
                $("#safetynet").html(result['value'].toFixed(2));
                $("#lastyearweight").html((result['lastYearWeight'] * 100).toFixed(2) + "%");
            } else {
                $("#safetynet").html("<i>Estimate will display when more data is entered</i>");
            }
        });
    })
</script>
</html>
